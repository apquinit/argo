package start

import (
	"{{.ProjectName}}/config"

	"github.com/gin-gonic/gin"
	"github.com/labstack/echo/v4/middleware"
)

// InitializeKernel sets up the Gin engine
func InitializeKernel() *gin.Engine {
	// Load configuration
	cfg := config.LoadAppConfig()

	// Set mode
	if cfg.Mode == "release" {
		gin.SetMode(gin.ReleaseMode)
	} else {
		gin.SetMode(gin.DebugMode)
	}

	// Initialize the engine
	engine := gin.Default()

	// Setup CORS
	SetupCORS(engine)

	// Register routes
	RegisterRoutes(engine)

	// Register global middleware
	engine.Use(middleware.Logger())
	engine.Use(middleware.CORS())

	// Register custom middleware

	return engine
}
